(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28e44d9c"],{"059c":function(t,e,a){t.exports=a.p+"static/img/admin.cf376cee.png"},"454f":function(t,e,a){a("46a7");var i=a("584a").Object;t.exports=function(t,e,a){return i.defineProperty(t,e,a)}},"46a7":function(t,e,a){var i=a("63b6");i(i.S+i.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"7ed4":function(t,e,a){"use strict";var i=a("2b0e"),n=new i["default"];e["a"]=n},"85f2":function(t,e,a){t.exports=a("454f")},"91f0":function(t,e,a){},bd86:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var i=a("85f2"),n=a.n(i);function s(t,e,a){return e in t?n()(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},e2ad:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:8}},[i("el-card",{staticClass:"mgb20",staticStyle:{height:"252px"},attrs:{shadow:"hover"}},[i("div",{staticClass:"user-info"},[i("img",{staticClass:"user-avator",attrs:{src:a("059c"),alt:""}}),i("div",{staticClass:"user-info-cont"},[i("div",{staticClass:"user-info-name"},[t._v(t._s(t.managerData.name))]),i("div",[t._v(t._s(t.managerData.role))])])]),i("div",{staticClass:"user-info-list"},[t._v("\n                    管理员ID\n                    "),i("span",[t._v(t._s(t.managerData.managerId))])]),i("div",{staticClass:"user-info-list"},[t._v("\n                    已工作时间\n                    "),i("span",[t._v(t._s(t.workTime))])])]),i("el-card",{staticStyle:{height:"252px"},attrs:{shadow:"hover"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("交易金额比例")])]),t._v("\n                消费\n                "),t.getDealRadio?i("el-progress",{attrs:{percentage:t.getDealRadio,color:"#42b983"}}):t._e(),t._v("\n                充值\n                "),t.rechargeRadio?i("el-progress",{attrs:{percentage:t.rechargeRadio,color:"#f1e05a"}}):t._e(),t._v("\n                积分兑换\n                "),t.integralRadio?i("el-progress",{attrs:{percentage:t.integralRadio}}):t._e()],1)],1),i("el-col",{attrs:{span:16}},[i("el-row",{staticClass:"mgb20",attrs:{gutter:20}},[i("el-col",{attrs:{span:8}},[i("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[i("div",{staticClass:"grid-content grid-con-1"},[i("i",{staticClass:"el-icon-lx-people grid-con-icon"}),i("div",{staticClass:"grid-cont-right"},[i("div",{staticClass:"grid-num"},[t._v(t._s(t.statisticData.memberNum))]),i("div",[t._v("已注册会员")])])])])],1),i("el-col",{attrs:{span:8}},[i("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[i("div",{staticClass:"grid-content grid-con-2"},[i("i",{staticClass:"el-icon-lx-vipcard grid-con-icon"}),i("div",{staticClass:"grid-cont-right"},[i("div",{staticClass:"grid-num"},[t._v(t._s(t.statisticData.cardNum))]),i("div",[t._v("已办理会员卡")])])])])],1),i("el-col",{attrs:{span:8}},[i("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[i("div",{staticClass:"grid-content grid-con-3"},[i("i",{staticClass:"el-icon-lx-goods grid-con-icon"}),i("div",{staticClass:"grid-cont-right"},[i("div",{staticClass:"grid-num"},[t._v(t._s(t.statisticData.movieNum))]),i("div",[t._v("已售电影票")])])])])],1)],1),i("el-card",{staticStyle:{height:"403px"},attrs:{shadow:"hover"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("电影票")]),i("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.handleInsertMovie}},[t._v("添加")])],1),i("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.movieData,border:"","header-cell-class-name":"table-header"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),i("el-table-column",{attrs:{prop:"movieId",label:"ID",width:"55",align:"center"}}),i("el-table-column",{attrs:{prop:"name",label:"电影名"}}),i("el-table-column",{attrs:{prop:"price",label:"价格",width:"55"}}),i("el-table-column",{attrs:{prop:"time",label:"时间"}}),i("el-table-column",{attrs:{prop:"integral",label:"积分",width:"55"}}),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑\n                            ")]),i("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("删除\n                            ")])]}}])})],1),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal},on:{"current-change":t.handlePageChange}})],1),i("el-dialog",{attrs:{title:"编辑",visible:t.editVisible,width:"30%"},on:{"update:visible":function(e){t.editVisible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"70px"}},[i("el-form-item",{attrs:{label:"电影名"}},[i("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"价格"}},[i("el-input",{model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),i("el-form-item",{attrs:{label:"积分"}},[i("el-input",{model:{value:t.form.integral,callback:function(e){t.$set(t.form,"integral",e)},expression:"form.integral"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"添加",visible:t.insertVisible,width:"30%"},on:{"update:visible":function(e){t.insertVisible=e}}},[i("el-form",{ref:"form",attrs:{model:t.insertForm,"label-width":"70px"}},[i("el-form-item",{attrs:{label:"电影名"}},[i("el-input",{model:{value:t.insertForm.name,callback:function(e){t.$set(t.insertForm,"name",e)},expression:"insertForm.name"}})],1),i("el-form-item",{attrs:{label:"价格"}},[i("el-input",{model:{value:t.insertForm.price,callback:function(e){t.$set(t.insertForm,"price",e)},expression:"insertForm.price"}})],1),i("el-form-item",{attrs:{label:"积分"}},[i("el-input",{model:{value:t.insertForm.integral,callback:function(e){t.$set(t.insertForm,"integral",e)},expression:"insertForm.integral"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.insertVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.saveMovie}},[t._v("确 定")])],1)],1)],1)],1)],1)],1)},n=[],s=a("bd86"),r=a("7ed4"),o=a("365c"),l={name:"dashboard",data:function(){return{query:{pageIndex:1,pageSize:4,movieId:"",managerId:localStorage.getItem("managerId")},movieData:[],movieAllData:[],managerData:{},dealData:{},statisticData:{},pageTotal:0,form:{},insertForm:{},editVisible:!1,insertVisible:!1,total:0,multipleSelection:[],defaultManagerId:"admin",timer:"",workTime:""}},created:function(){var t=this,e=this;this.getMovieData(),this.getManagerData(),this.getStatisticData(),this.getDealData(),r["a"].$on("member-change",(function(){t.getStatisticData()})),r["a"].$on("card-change",(function(){t.getStatisticData()})),r["a"].$on("integral-change",(function(){t.getDealData()})),r["a"].$on("recharge-change",(function(){t.getDealData()})),r["a"].$on("movie-change",(function(){t.getStatisticData(),t.getDealData()})),e.timer=setInterval((function(){e.workTime=e.getHour()+new Date(new Date-new Date(e.managerData.time)).getMinutes()+":"+e.getSecond()}),1e3)},beforeMount:function(){},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},computed:{totalNumber:function(){return this.dealData.consume+this.dealData.recharge+this.dealData.integral},getDealRadio:function(){return Math.round(this.dealData.consume/this.totalNumber*100)},rechargeRadio:function(){return Math.round(this.dealData.recharge/this.totalNumber*100)},integralRadio:function(){return Math.round(this.dealData.integral/this.totalNumber*100)}},methods:Object(s["a"])({getSecond:function(){var t=new Date(new Date-new Date(this.managerData.time)).getSeconds();return t<10?"0"+t:t},getHour:function(){var t=new Date(new Date-new Date(this.managerData.time)).getHours()-8;return t>0?t+":":""},handleDelete:function(t,e){var a=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){Object(o["e"])(e).then((function(t){200==t.status?(a.$message.success("删除成功"),a.getMovieData()):a.$message.error("删除失败，服务器出现故障")}))})).catch((function(){}))},handleEdit:function(t,e){this.idx=t,this.form=e,this.editVisible=!0},saveEdit:function(){var t=this;Object(o["r"])(this.form).then((function(e){200==e.status?(t.editVisible=!1,t.$message.success("修改第 ".concat(t.idx+1," 行成功")),t.getMovieData()):t.$message.error("修改失败，服务端出现错误")}))},handlePageChange:function(t){var e;this.$set(this.query,"pageIndex",t),this.movieData=[];var a=(this.query.pageIndex-1)*this.query.pageSize,i=this.query.pageSize*this.query.pageIndex;for(this.pageTotal<i&&(i=this.pageTotal),e=a;e<i;e++)this.movieData.push(this.movieAllData[e])},getMovieData:function(){var t=this,e={pageIndex:this.query.pageIndex,pageSize:0};Object(o["s"])(e).then((function(e){var a;t.movieData=[],t.movieAllData=e.data.list,t.pageTotal=e.data.pageTotal||20;var i=(t.query.pageIndex-1)*t.query.pageSize,n=t.query.pageSize*t.query.pageIndex;for(t.pageTotal<n&&(n=t.pageTotal),a=i;a<n;a++)t.movieData.push(t.movieAllData[a]);localStorage.setItem("movieData",JSON.stringify(t.movieAllData)),r["a"].$emit("movieData-change")}))},getManagerData:function(){var t=this;Object(o["n"])(this.query).then((function(e){t.managerData=e.data,t.workTime=t.getHour()+new Date(new Date-new Date(t.managerData.time)).getMinutes()+":"+t.getSecond()}))},getDealData:function(){var t=this;Object(o["c"])().then((function(e){t.dealData=e}))},getStatisticData:function(){var t=this;Object(o["z"])().then((function(e){t.statisticData=e.data}))},handleSelectionChange:function(t){this.multipleSelection=t},handleInsertMovie:function(){this.insertForm={},this.insertVisible=!0},saveMovie:function(){var t=this;Object(o["k"])(this.insertForm).then((function(e){200==e.status?(t.insertVisible=!1,t.$message.success("添加成功"),t.getMovieData()):(t.insertVisible=!1,t.$message.success("添加失败，服务端出现问题"))}))}},"getDealData",(function(){var t=this;Object(o["y"])().then((function(e){200==e.status&&(t.dealData=e.data)}))}))},c=l,d=(a("e919"),a("2877")),u=Object(d["a"])(c,i,n,!1,null,"3488378c",null);e["default"]=u.exports},e919:function(t,e,a){"use strict";var i=a("91f0"),n=a.n(i);n.a}}]);